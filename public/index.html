<html>

<head>
    <title>Gesture Talk</title>
    <style>
    .fullscreen {
        position: absolute;
        top: 0;
        right: 0;
        bottom: 0;
        left: 0;
    }
    
    .column {
        display: flex;
        flex-direction: row;
    }
    
    .row {
        display: flex;
        flex-direction: column;
    }
    
    .flex {
        flex: 1;
    }
    
    .main-panel {
        text-align: center;
        align-items: center;
        justify-content: center;
    }
    
    .side-panel {
        width: 30%;
        background-color: lightgray;
        padding: 8px;
        text-align: center;
    }
    
    .empty-chatbox {
        height: 200px;
        width: 200px;
        line-height: 200px;
        background-color: gray;
        border-radius: 200px;
        display: inline-block;
    }
    
    .empty-chatbox-message {
        width: 200px;
    }
    
    .hand-image {
        height: 200px;
        width: 200px;
    }
    
    .silhouette {
        height: 200px;
        width: 200px;
        margin-left: 16px;
        background-image: url('silhouette.png');
        background-repeat: no-repeat;
        background-size: contain;
        background-position: center;
    }
    </style>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script type="text/javascript" src="lib/MyoJS-master/myo.js"></script>
    <script>
    Myo.connect();

    Myo.on('fingers_spread', function() {
        speak("Activation pose detected, connecting to chat room.", function() {
            joinRoom();
        });
    });

    var socket = io();

    socket.on('joined_room', function(id) {
        speak("Alexa, ask Gesture Talk to join the room with I.D. " + id);
    });

    socket.on('chatroom_begin', function() {
        speak('Successfully joined chatroom with Alexa.');
    });

    function joinRoom() {
        socket.emit('start_room');
    }

    function speak(text, callback) {
        var u = new SpeechSynthesisUtterance();
        u.text = text;
        u.lang = 'en-US';

        u.onend = function() {
            if (callback) {
                callback();
            }
        };

        u.onerror = function(e) {
            if (callback) {
                callback(e);
            }
        };

        speechSynthesis.speak(u);
    }
    </script>
</head>

<body class="fullscreen column">
    <div class="flex main-panel row">
        <div class="empty-chatbox"><img class="hand-image" src="blue_hand.png"></img>
        </div>
        <div class="empty-chatbox-message">To begin chatting, make the 'Fingers spread' gesture or click 'Start Room'</div>
        <button onclick="joinRoom()">Start Room</button>
    </div>
    <div class="side-panel">
        <h1>Gesture Chat</h1> Welcome to the Gesture/Voice messaging app
        <div class="silhouette"></div>
        <div>Your Name Here</div>
    </div>
</body>

</html>